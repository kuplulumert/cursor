<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generalized Cyclone Parameter Calculator with Comparison</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: font-size 0.2s ease-in-out;
        }
        .input-group {
            display: grid;
            grid-template-columns: 1.5fr 100px 85px; 
            gap: 0.5rem;
            align-items: center;
        }
        .input-field {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
            transition: all 0.2s ease-in-out;
            background-color: #ffffff;
        }
        .input-field:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            background-color: #fefefe;
        }
        .input-field:hover {
            border-color: #9ca3af;
            background-color: #fafafa;
        }
        .instant-input {
            border: 2px solid #e5e7eb !important;
            transition: all 0.2s ease-in-out;
            background-color: #ffffff;
        }
        .instant-input:focus {
            outline: none;
            border-color: #4f46e5 !important;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            background-color: #fefefe;
        }
        .instant-input:hover {
            border-color: #6b7280 !important;
            background-color: #f9fafb;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        .data-table th, .data-table td {
            border: 1px solid #e2e8f0;
            padding: 0.75rem;
            text-align: center;
            transition: font-size 0.2s ease-in-out;
        }
        .data-table th {
            background-color: #f8fafc;
            font-weight: 600;
        }
        .control-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .control-btn {
            padding: 0.5rem; border-radius: 9999px; background-color: #e5e7eb;
        }
        .control-btn:hover { background-color: #d1d5db; }
        .layout-btn {
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-size: 0.875rem;
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Main container -->
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Generalized Cyclone Parameter Calculator</h1>
        
        <!-- Controls -->
        <div class="control-container mb-6 justify-center">
            <div class="control-group">
                <label class="text-sm font-medium text-gray-700">Font Size:</label>
                <button class="control-btn" onclick="adjustFontSize(-1)">-</button>
                <span id="fontSizeDisplay" class="text-sm font-medium">16px</span>
                <button class="control-btn" onclick="adjustFontSize(1)">+</button>
            </div>
            <div class="control-group">
                <label class="text-sm font-medium text-gray-700">Layout:</label>
                <button class="layout-btn" onclick="setLayout('horizontal')">Horizontal</button>
                <button class="layout-btn" onclick="setLayout('vertical')">Vertical</button>
            </div>
        </div>

        <!-- Main content area -->
        <div id="mainContent" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left Panel: Input Parameters -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">Input Parameters</h2>
                
                <!-- Parameters will be dynamically generated -->
                <div id="parametersContainer"></div>
                
                <!-- Add Parameter Button -->
                <button onclick="addParameter()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                    Add Parameter
                </button>
                
                <!-- Calculate Button -->
                <button onclick="calculateAll()" class="mt-4 ml-2 px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-semibold">
                    Calculate All
                </button>
            </div>

            <!-- Right Panel: Results and Charts -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">Results & Analysis</h2>
                
                <!-- Results Table -->
                <div id="resultsContainer">
                    <table class="data-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Value</th>
                                <th>Unit</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody">
                        </tbody>
                    </table>
                </div>
                
                <!-- Chart Container -->
                <div class="mt-6">
                    <canvas id="comparisonChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Comparison Section -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Parameter Comparison</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-medium mb-2">Scenario A</h3>
                    <div id="scenarioA" class="border-2 border-dashed border-gray-300 p-4 rounded-lg min-h-32">
                        Drop parameters here to compare
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-medium mb-2">Scenario B</h3>
                    <div id="scenarioB" class="border-2 border-dashed border-gray-300 p-4 rounded-lg min-h-32">
                        Drop parameters here to compare
                    </div>
                </div>
            </div>
            <button onclick="compareScenarios()" class="mt-4 px-6 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors font-semibold">
                Compare Scenarios
            </button>
        </div>
    </div>

    <script>
        // Global variables
        let parameters = [];
        let parameterCounter = 0;
        let chart = null;
        let currentFontSize = 16;

        // Font size adjustment
        function adjustFontSize(delta) {
            currentFontSize = Math.max(12, Math.min(24, currentFontSize + delta));
            document.body.style.fontSize = currentFontSize + 'px';
            document.getElementById('fontSizeDisplay').textContent = currentFontSize + 'px';
        }

        // Layout switching
        function setLayout(layout) {
            const mainContent = document.getElementById('mainContent');
            if (layout === 'horizontal') {
                mainContent.className = 'grid grid-cols-1 lg:grid-cols-2 gap-8';
            } else {
                mainContent.className = 'flex flex-col gap-8';
            }
        }

        // Parameter management
        function addParameter() {
            const id = ++parameterCounter;
            const parameter = {
                id: id,
                name: `Parameter ${id}`,
                value: '',
                unit: '',
                formula: '',
                dependencies: []
            };
            parameters.push(parameter);
            renderParameters();
        }

        function removeParameter(id) {
            parameters = parameters.filter(p => p.id !== id);
            renderParameters();
            updateResults();
        }

        function renderParameters() {
            const container = document.getElementById('parametersContainer');
            container.innerHTML = '';
            
            parameters.forEach(param => {
                const div = document.createElement('div');
                div.className = 'mb-4 p-4 border border-gray-200 rounded-lg';
                div.innerHTML = `
                    <div class="input-group mb-2">
                        <input type="text" value="${param.name}" 
                               onchange="updateParameter(${param.id}, 'name', this.value)"
                               class="input-field" placeholder="Parameter name">
                        <input type="number" value="${param.value}" 
                               onchange="updateParameter(${param.id}, 'value', this.value)"
                               class="instant-input" placeholder="Value" step="any">
                        <input type="text" value="${param.unit}" 
                               onchange="updateParameter(${param.id}, 'unit', this.value)"
                               class="input-field" placeholder="Unit">
                    </div>
                    <div class="mb-2">
                        <input type="text" value="${param.formula}" 
                               onchange="updateParameter(${param.id}, 'formula', this.value)"
                               class="input-field w-full" placeholder="Formula (optional)">
                    </div>
                    <button onclick="removeParameter(${param.id})" 
                            class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">
                        Remove
                    </button>
                `;
                container.appendChild(div);
            });
        }

        function updateParameter(id, field, value) {
            const param = parameters.find(p => p.id === id);
            if (param) {
                param[field] = value;
                if (field === 'value' && value !== '') {
                    updateResults();
                }
            }
        }

        // Calculation and results
        function calculateAll() {
            // Perform calculations for parameters with formulas
            parameters.forEach(param => {
                if (param.formula && param.formula.trim() !== '') {
                    try {
                        // Simple formula evaluation (you can expand this)
                        const result = evaluateFormula(param.formula);
                        param.value = result;
                    } catch (error) {
                        console.error(`Error calculating ${param.name}:`, error);
                    }
                }
            });
            
            renderParameters();
            updateResults();
            updateChart();
        }

        function evaluateFormula(formula) {
            // Simple formula evaluator - replace parameter names with values
            let expression = formula;
            parameters.forEach(param => {
                if (param.value !== '') {
                    expression = expression.replace(new RegExp(param.name, 'g'), param.value);
                }
            });
            
            // Basic math evaluation (extend as needed)
            try {
                return Function('"use strict"; return (' + expression + ')')();
            } catch (error) {
                throw new Error('Invalid formula');
            }
        }

        function updateResults() {
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = '';
            
            parameters.forEach(param => {
                if (param.value !== '') {
                    const row = document.createElement('tr');
                    const status = param.value > 0 ? 'Valid' : 'Check';
                    const statusClass = param.value > 0 ? 'text-green-600' : 'text-yellow-600';
                    
                    row.innerHTML = `
                        <td class="font-medium">${param.name}</td>
                        <td>${parseFloat(param.value).toFixed(2)}</td>
                        <td>${param.unit}</td>
                        <td class="${statusClass}">${status}</td>
                    `;
                    tbody.appendChild(row);
                }
            });
        }

        function updateChart() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }
            
            const validParams = parameters.filter(p => p.value !== '' && !isNaN(p.value));
            
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: validParams.map(p => p.name),
                    datasets: [{
                        label: 'Parameter Values',
                        data: validParams.map(p => parseFloat(p.value)),
                        backgroundColor: 'rgba(79, 70, 229, 0.6)',
                        borderColor: 'rgba(79, 70, 229, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Drag and drop for comparison
        function initializeDragAndDrop() {
            const scenarioA = document.getElementById('scenarioA');
            const scenarioB = document.getElementById('scenarioB');
            
            new Sortable(scenarioA, {
                group: 'scenarios',
                animation: 150
            });
            
            new Sortable(scenarioB, {
                group: 'scenarios',
                animation: 150
            });
        }

        function compareScenarios() {
            // Implementation for scenario comparison
            console.log('Comparing scenarios...');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
            addParameter(); // Add first parameter by default
        });
    </script>
</body>
</html>